{% extends 'base.html' %}
{% block title %}Session on {{ session.date }}{% endblock %}

{% block content %}
<main>
  <section>
    <h2>Practice Session – {{ session.date }}</h2>

    <p><strong>Duration:</strong> {{ session.duration_minutes }} minutes</p>
    <p><strong>Speed:</strong> {{ session.speed }}</p>
    <p><strong>Mistakes:</strong> {{ session.mistakes }}</p>

    {% if session.goal %}
      <p><strong>Associated Goal:</strong>
        <a href="{% url 'goal_detail' session.goal.pk %}">{{ session.goal.title }}</a>
      </p>
    {% else %}
      <p><em>No goal linked to this session.</em></p>
    {% endif %}
  </section>
  <section>
    <h2>Session Performance vs Goal</h2>
    {% with progress=session.get_progress_against_goal %}     
      {% if progress %}
        {% for metric, value in progress.items %}
          <div style="margin-bottom: 1em;">
            <strong>{{ metric|title }}</strong>
            <div style="background-color: #ddd; height: 20px; border-radius: 5px;">
              <div style="
                background-color: #2196f3;
                width: {{ value|floatformat:0 }}%;
                height: 100%;
                border-radius: 5px;
                text-align: right;
                padding-right: 5px;
                color: white;
                font-size: 12px;
              ">
                {{ value|floatformat:0 }}%
              </div>
            </div>
          </div>
        {% endfor %}
      {% else %}
        <p>This session is not linked to a goal or has no measurable progress.</p>
      {% endif %}
    {% endwith %}
  </section>



  <a href="{% url 'dashboard' %}">← Back to Sessions</a>
</main>
{% endblock %}